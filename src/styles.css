:root {
  --bg: #0f1115;
  --panel: #171a21;
  --text: #e6e8ee;
  --muted: #9aa3b2;
  --accent: #3aa675;
  --accent-weak: #2a7d57;
  --danger: #d9534f;
  --border: #232732;
}

* { box-sizing: border-box; }
html, body { height: 100%; }
body {
  margin: 0;
  background: var(--bg);
  color: var(--text);
  font: 14px/1.4 -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
}

.app-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 16px;
  border-bottom: 1px solid var(--border);
}
.app-header h1 { font-size: 18px; margin: 0; }
.actions { display: flex; gap: 8px; }

.file-btn {
  position: relative;
  overflow: hidden;
  border: 1px solid var(--border);
  padding: 6px 10px;
  border-radius: 6px;
  background: var(--panel);
  color: var(--text);
  cursor: pointer;
}
.file-btn input[type="file"] {
  position: absolute;
  inset: 0;
  opacity: 0;
  cursor: pointer;
}

button {
  border: 1px solid var(--border);
  padding: 6px 10px;
  border-radius: 6px;
  background: var(--panel);
  color: var(--text);
  cursor: pointer;
}
button:disabled { opacity: .6; cursor: not-allowed; }
button#pickColorBtn.active { outline: 2px solid var(--accent); }
button#cancelExportBtn { border-color: var(--danger); color: #fff; background: #982d2a; }

.app-main {
  display: grid;
  grid-template-columns: 1fr 320px;
  gap: 12px;
  padding: 12px;
  height: calc(100% - 60px);
}
.stage {
  display: block;
  min-height: 0;
  border: 1px solid var(--border);
  border-radius: 8px;
  background: #0b0d12;
  padding: 8px;
}
.drop-zone {
  position: relative;
  width: 100%;
  height: 60vh;
  min-height: 320px;
  display: grid;
  place-items: center;
  overflow: hidden;
}
.player-bar { display:flex; align-items:center; gap:8px; padding:8px 4px; }
.player-bar input[type="range"] { flex:1; }
.timeline { margin-top: 6px; border:1px solid var(--border); border-radius:8px; background: var(--panel); }
.timeline-header { display:flex; justify-content:space-between; align-items:center; padding:6px 8px; border-bottom:1px solid var(--border); }
.timeline .tools { display:flex; gap:6px; align-items:center; }
.clips-track { position:relative; min-height:56px; background:#0b0d12; }
.clip { position:absolute; top:8px; height:40px; background:#2a7d57; border:1px solid #1b5a3e; border-radius:6px; cursor:move; }
.clip .clip-label { position:absolute; left:-80px; top:50%; transform:translateY(-50%); color:#e6e8ee; font-size:12px; opacity:.8; }
.clip .handle { position:absolute; top:0; width:8px; height:100%; background:#174f38; cursor:ew-resize; }
.clip .handle.left { left:-4px; border-radius:6px 0 0 6px; }
.clip .handle.right { right:-4px; border-radius:0 6px 6px 0; }
.clip.selected { outline:2px solid #7ec8a5; }
.clip .clip-btn { position:absolute; top:2px; right:2px; background:#0f1115; color:#e6e8ee; border:1px solid #1b5a3e; border-radius:4px; font-size:12px; padding:2px 6px; cursor:pointer; }
.clip .clip-btn.del { right:2px; }
.clip .clip-btn.reset { right:44px; }
.tool { padding:4px 8px; }
.tool.active { background:#2a7d57; border-color:#1b5a3e; color:#fff; }
.pick-overlay .box { border:2px solid #3aa675; box-shadow:0 0 0 2px rgba(58,166,117,.3) inset; border-radius:2px; }
.drop-zone.dragover { outline: 2px dashed var(--accent); outline-offset: -8px; }
.preview { max-width: 100%; max-height: 100%; background: #000; }
.post { position:absolute; pointer-events:none; }
.hint { position: absolute; color: var(--muted); }
.preview.picking { cursor: crosshair; }

.pick-overlay { position:absolute; inset:0; pointer-events:none; }
.pick-overlay .box { position:absolute; border:2px solid #3aa675; box-shadow:0 0 0 2px rgba(58,166,117,.3) inset; border-radius:2px; }
.pick-overlay .mini-swatch { position:absolute; width:18px; height:18px; border:1px solid var(--border); border-radius:3px; background:#000; transform:translate(8px,8px); }

.sidebar { display: flex; flex-direction: column; gap: 12px; }
.panel {
  background: var(--panel);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 12px;
}
.panel h2 { margin: 0 0 8px; font-size: 14px; color: var(--muted); }
.row { display: grid; grid-template-columns: 64px 1fr auto; align-items: center; gap: 8px; margin: 8px 0; }
.row > label { color: var(--muted); }
.row > button { grid-column: 1 / span 2; }
.row .val { color: var(--muted); min-width: 42px; text-align: right; }
.row input[type="range"] { width: 100%; }
.row input[type="color"] { width: 36px; height: 24px; padding: 0; border: none; background: transparent; }
.swatch { width: 24px; height: 24px; border-radius: 4px; border: 1px solid var(--border); }

.progress { position: relative; height: 10px; background: #0e1220; border-radius: 999px; border: 1px solid var(--border); overflow: hidden; }
.progress .bar { position: absolute; inset: 0 auto 0 0; width: 0%; background: linear-gradient(90deg, var(--accent-weak), var(--accent)); }
.progress .pct { margin-top: 6px; font-variant-numeric: tabular-nums; color: var(--muted); text-align: right; }

.export-result { margin-top: 8px; display: grid; gap: 6px; }
.export-result a { color: #7ec8a5; text-decoration: none; }
.export-result .svg-preview { position:relative; border:1px solid var(--border); border-radius:8px; overflow:hidden; background:#0b0d12; background-position:center; background-size:contain; background-repeat:no-repeat; }
.export-result .svg-preview img { display:block; width:100%; height:auto; }

.app-footer { padding: 8px 12px; border-top: 1px solid var(--border); color: var(--muted); }
.status { font-size: 12px; }

@media (max-width: 980px) {
  .app-main { grid-template-columns: 1fr; height: auto; }
}
